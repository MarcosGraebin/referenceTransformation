#include "SingleLib.h"

// Lookup table to avoid the use of math.h
const uint16_t sine_16[] = {0,17,35,53,71,89,107,125,142,160,178,
        196,214,232,250,268,285,303,321,339,357,
        375,393,411,428,446,464,482,500,518,536,
        553,571,589,607,625,643,661,679,696,714,
        732,750,768,786,804,822,839,857,875,893,
        911,929,947,964,982,1000,1018,1036,1054,1072,
        1089,1107,1125,1143,1161,1179,1197,1214,1232,1250,
        1268,1286,1304,1322,1339,1357,1375,1393,1411,1429,
        1447,1464,1482,1500,1518,1536,1554,1572,1589,1607,
        1625,1643,1661,1679,1697,1714,1732,1750,1768,1786,
        1804,1821,1839,1857,1875,1893,1911,1929,1946,1964,
        1982,2000,2018,2036,2053,2071,2089,2107,2125,2143,
        2160,2178,2196,2214,2232,2250,2267,2285,2303,2321,
        2339,2357,2374,2392,2410,2428,2446,2463,2481,2499,
        2517,2535,2553,2570,2588,2606,2624,2642,2659,2677,
        2695,2713,2731,2748,2766,2784,2802,2820,2838,2855,
        2873,2891,2909,2927,2944,2962,2980,2998,3016,3033,
        3051,3069,3087,3104,3122,3140,3158,3176,3193,3211,
        3229,3247,3265,3282,3300,3318,3336,3353,3371,3389,
        3407,3425,3442,3460,3478,3496,3513,3531,3549,3567,
        3585,3602,3620,3638,3656,3673,3691,3709,3727,3744,
        3762,3780,3798,3815,3833,3851,3869,3886,3904,3922,
        3940,3957,3975,3993,4011,4028,4046,4064,4081,4099,
        4117,4135,4152,4170,4188,4206,4223,4241,4259,4276,
        4294,4312,4330,4347,4365,4383,4400,4418,4436,4454,
        4471,4489,4507,4524,4542,4560,4577,4595,4613,4631,
        4648,4666,4684,4701,4719,4737,4754,4772,4790,4807,
        4825,4843,4860,4878,4896,4913,4931,4949,4966,4984,
        5002,5019,5037,5055,5072,5090,5108,5125,5143,5161,
        5178,5196,5214,5231,5249,5267,5284,5302,5319,5337,
        5355,5372,5390,5408,5425,5443,5460,5478,5496,5513,
        5531,5549,5566,5584,5601,5619,5637,5654,5672,5689,
        5707,5725,5742,5760,5777,5795,5813,5830,5848,5865,
        5883,5901,5918,5936,5953,5971,5988,6006,6024,6041,
        6059,6076,6094,6111,6129,6146,6164,6182,6199,6217,
        6234,6252,6269,6287,6304,6322,6339,6357,6374,6392,
        6410,6427,6445,6462,6480,6497,6515,6532,6550,6567,
        6585,6602,6620,6637,6655,6672,6690,6707,6725,6742,
        6760,6777,6795,6812,6830,6847,6865,6882,6900,6917,
        6934,6952,6969,6987,7004,7022,7039,7057,7074,7092,
        7109,7126,7144,7161,7179,7196,7214,7231,7249,7266,
        7283,7301,7318,7336,7353,7370,7388,7405,7423,7440,
        7458,7475,7492,7510,7527,7544,7562,7579,7597,7614,
        7631,7649,7666,7684,7701,7718,7736,7753,7770,7788,
        7805,7822,7840,7857,7875,7892,7909,7927,7944,7961,
        7979,7996,8013,8031,8048,8065,8083,8100,8117,8134,
        8152,8169,8186,8204,8221,8238,8256,8273,8290,8307,
        8325,8342,8359,8377,8394,8411,8428,8446,8463,8480,
        8497,8515,8532,8549,8567,8584,8601,8618,8635,8653,
        8670,8687,8704,8722,8739,8756,8773,8791,8808,8825,
        8842,8859,8877,8894,8911,8928,8945,8963,8980,8997,
        9014,9031,9048,9066,9083,9100,9117,9134,9151,9169,
        9186,9203,9220,9237,9254,9272,9289,9306,9323,9340,
        9357,9374,9391,9409,9426,9443,9460,9477,9494,9511,
        9528,9545,9563,9580,9597,9614,9631,9648,9665,9682,
        9699,9716,9733,9750,9767,9785,9802,9819,9836,9853,
        9870,9887,9904,9921,9938,9955,9972,9989,10006,10023,
        10040,10057,10074,10091,10108,10125,10142,10159,10176,10193,
        10210,10227,10244,10261,10278,10295,10312,10329,10346,10363,
        10380,10397,10414,10431,10447,10464,10481,10498,10515,10532,
        10549,10566,10583,10600,10617,10634,10650,10667,10684,10701,
        10718,10735,10752,10769,10786,10802,10819,10836,10853,10870,
        10887,10904,10921,10937,10954,10971,10988,11005,11022,11038,
        11055,11072,11089,11106,11122,11139,11156,11173,11190,11206,
        11223,11240,11257,11274,11290,11307,11324,11341,11357,11374,
        11391,11408,11425,11441,11458,11475,11491,11508,11525,11542,
        11558,11575,11592,11609,11625,11642,11659,11675,11692,11709,
        11725,11742,11759,11776,11792,11809,11826,11842,11859,11876,
        11892,11909,11925,11942,11959,11975,11992,12009,12025,12042,
        12059,12075,12092,12108,12125,12142,12158,12175,12191,12208,
        12225,12241,12258,12274,12291,12307,12324,12340,12357,12374,
        12390,12407,12423,12440,12456,12473,12489,12506,12522,12539,
        12555,12572,12588,12605,12621,12638,12654,12671,12687,12704,
        12720,12737,12753,12770,12786,12803,12819,12835,12852,12868,
        12885,12901,12918,12934,12950,12967,12983,13000,13016,13033,
        13049,13065,13082,13098,13114,13131,13147,13164,13180,13196,
        13213,13229,13245,13262,13278,13294,13311,13327,13343,13360,
        13376,13392,13409,13425,13441,13458,13474,13490,13506,13523,
        13539,13555,13571,13588,13604,13620,13637,13653,13669,13685,
        13701,13718,13734,13750,13766,13783,13799,13815,13831,13847,
        13864,13880,13896,13912,13928,13945,13961,13977,13993,14009,
        14025,14042,14058,14074,14090,14106,14122,14138,14154,14171,
        14187,14203,14219,14235,14251,14267,14283,14299,14315,14331,
        14348,14364,14380,14396,14412,14428,14444,14460,14476,14492,
        14508,14524,14540,14556,14572,14588,14604,14620,14636,14652,
        14668,14684,14700,14716,14732,14748,14764,14780,14796,14812,
        14828,14844,14859,14875,14891,14907,14923,14939,14955,14971,
        14987,15003,15019,15034,15050,15066,15082,15098,15114,15130,
        15145,15161,15177,15193,15209,15225,15240,15256,15272,15288,
        15304,15320,15335,15351,15367,15383,15398,15414,15430,15446,
        15462,15477,15493,15509,15525,15540,15556,15572,15587,15603,
        15619,15635,15650,15666,15682,15697,15713,15729,15744,15760,
        15776,15791,15807,15823,15838,15854,15870,15885,15901,15917,
        15932,15948,15963,15979,15995,16010,16026,16041,16057,16072,
        16088,16104,16119,16135,16150,16166,16181,16197,16212,16228,
        16244,16259,16275,16290,16306,16321,16337,16352,16368,16383,
        16398,16414,16429,16445,16460,16476,16491,16507,16522,16538,
        16553,16568,16584,16599,16615,16630,16645,16661,16676,16692,
        16707,16722,16738,16753,16768,16784,16799,16814,16830,16845,
        16860,16876,16891,16906,16922,16937,16952,16968,16983,16998,
        17013,17029,17044,17059,17074,17090,17105,17120,17135,17151,
        17166,17181,17196,17212,17227,17242,17257,17272,17288,17303,
        17318,17333,17348,17363,17379,17394,17409,17424,17439,17454,
        17469,17484,17500,17515,17530,17545,17560,17575,17590,17605,
        17620,17635,17650,17665,17680,17696,17711,17726,17741,17756,
        17771,17786,17801,17816,17831,17846,17861,17876,17891,17906,
        17921,17936,17950,17965,17980,17995,18010,18025,18040,18055,
        18070,18085,18100,18115,18130,18144,18159,18174,18189,18204,
        18219,18234,18248,18263,18278,18293,18308,18323,18337,18352,
        18367,18382,18397,18411,18426,18441,18456,18470,18485,18500,
        18515,18529,18544,18559,18574,18588,18603,18618,18633,18647,
        18662,18677,18691,18706,18721,18735,18750,18765,18779,18794,
        18809,18823,18838,18852,18867,18882,18896,18911,18925,18940,
        18955,18969,18984,18998,19013,19027,19042,19056,19071,19086,
        19100,19115,19129,19144,19158,19173,19187,19202,19216,19231,
        19245,19259,19274,19288,19303,19317,19332,19346,19361,19375,
        19389,19404,19418,19433,19447,19461,19476,19490,19504,19519,
        19533,19547,19562,19576,19590,19605,19619,19633,19648,19662,
        19676,19691,19705,19719,19733,19748,19762,19776,19790,19805,
        19819,19833,19847,19862,19876,19890,19904,19918,19933,19947,
        19961,19975,19989,20003,20018,20032,20046,20060,20074,20088,
        20102,20116,20131,20145,20159,20173,20187,20201,20215,20229,
        20243,20257,20271,20285,20299,20313,20327,20341,20355,20369,
        20383,20397,20411,20425,20439,20453,20467,20481,20495,20509,
        20523,20537,20551,20565,20579,20593,20607,20620,20634,20648,
        20662,20676,20690,20704,20718,20731,20745,20759,20773,20787,
        20800,20814,20828,20842,20856,20869,20883,20897,20911,20925,
        20938,20952,20966,20979,20993,21007,21021,21034,21048,21062,
        21075,21089,21103,21116,21130,21144,21157,21171,21185,21198,
        21212,21226,21239,21253,21266,21280,21294,21307,21321,21334,
        21348,21361,21375,21388,21402,21416,21429,21443,21456,21470,
        21483,21497,21510,21524,21537,21550,21564,21577,21591,21604,
        21618,21631,21645,21658,21671,21685,21698,21712,21725,21738,
        21752,21765,21778,21792,21805,21818,21832,21845,21858,21872,
        21885,21898,21912,21925,21938,21951,21965,21978,21991,22004,
        22018,22031,22044,22057,22071,22084,22097,22110,22123,22137,
        22150,22163,22176,22189,22202,22216,22229,22242,22255,22268,
        22281,22294,22307,22320,22333,22347,22360,22373,22386,22399,
        22412,22425,22438,22451,22464,22477,22490,22503,22516,22529,
        22542,22555,22568,22581,22594,22607,22620,22632,22645,22658,
        22671,22684,22697,22710,22723,22736,22749,22761,22774,22787,
        22800,22813,22826,22838,22851,22864,22877,22890,22902,22915,
        22928,22941,22953,22966,22979,22992,23004,23017,23030,23043,
        23055,23068,23081,23093,23106,23119,23131,23144,23157,23169,
        23182,23195,23207,23220,23232,23245,23258,23270,23283,23295,
        23308,23320,23333,23346,23358,23371,23383,23396,23408,23421,
        23433,23446,23458,23471,23483,23495,23508,23520,23533,23545,
        23558,23570,23583,23595,23607,23620,23632,23644,23657,23669,
        23682,23694,23706,23719,23731,23743,23756,23768,23780,23792,
        23805,23817,23829,23842,23854,23866,23878,23891,23903,23915,
        23927,23939,23952,23964,23976,23988,24000,24012,24025,24037,
        24049,24061,24073,24085,24097,24110,24122,24134,24146,24158,
        24170,24182,24194,24206,24218,24230,24242,24254,24266,24278,
        24290,24302,24314,24326,24338,24350,24362,24374,24386,24398,
        24410,24422,24434,24446,24457,24469,24481,24493,24505,24517,
        24529,24541,24552,24564,24576,24588,24600,24611,24623,24635,
        24647,24659,24670,24682,24694,24706,24717,24729,24741,24753,
        24764,24776,24788,24799,24811,24823,24834,24846,24858,24869,
        24881,24892,24904,24916,24927,24939,24951,24962,24974,24985,
        24997,25008,25020,25031,25043,25054,25066,25077,25089,25100,
        25112,25123,25135,25146,25158,25169,25181,25192,25204,25215,
        25226,25238,25249,25261,25272,25283,25295,25306,25317,25329,
        25340,25351,25363,25374,25385,25397,25408,25419,25430,25442,
        25453,25464,25475,25487,25498,25509,25520,25532,25543,25554,
        25565,25576,25587,25599,25610,25621,25632,25643,25654,25665,
        25677,25688,25699,25710,25721,25732,25743,25754,25765,25776,
        25787,25798,25809,25820,25831,25842,25853,25864,25875,25886,
        25897,25908,25919,25930,25941,25952,25963,25974,25984,25995,
        26006,26017,26028,26039,26050,26060,26071,26082,26093,26104,
        26115,26125,26136,26147,26158,26168,26179,26190,26201,26211,
        26222,26233,26243,26254,26265,26276,26286,26297,26308,26318,
        26329,26339,26350,26361,26371,26382,26393,26403,26414,26424,
        26435,26445,26456,26466,26477,26488,26498,26509,26519,26530,
        26540,26551,26561,26571,26582,26592,26603,26613,26624,26634,
        26644,26655,26665,26676,26686,26696,26707,26717,26727,26738,
        26748,26758,26769,26779,26789,26800,26810,26820,26830,26841,
        26851,26861,26871,26882,26892,26902,26912,26922,26933,26943,
        26953,26963,26973,26983,26994,27004,27014,27024,27034,27044,
        27054,27064,27074,27084,27094,27104,27115,27125,27135,27145,
        27155,27165,27175,27185,27195,27204,27214,27224,27234,27244,
        27254,27264,27274,27284,27294,27304,27314,27323,27333,27343,
        27353,27363,27373,27382,27392,27402,27412,27422,27431,27441,
        27451,27461,27470,27480,27490,27500,27509,27519,27529,27538,
        27548,27558,27567,27577,27587,27596,27606,27616,27625,27635,
        27645,27654,27664,27673,27683,27692,27702,27711,27721,27731,
        27740,27750,27759,27769,27778,27787,27797,27806,27816,27825,
        27835,27844,27854,27863,27872,27882,27891,27901,27910,27919,
        27929,27938,27947,27957,27966,27975,27985,27994,28003,28012,
        28022,28031,28040,28049,28059,28068,28077,28086,28096,28105,
        28114,28123,28132,28141,28151,28160,28169,28178,28187,28196,
        28205,28214,28223,28233,28242,28251,28260,28269,28278,28287,
        28296,28305,28314,28323,28332,28341,28350,28359,28368,28377,
        28385,28394,28403,28412,28421,28430,28439,28448,28457,28465,
        28474,28483,28492,28501,28510,28518,28527,28536,28545,28554,
        28562,28571,28580,28589,28597,28606,28615,28623,28632,28641,
        28649,28658,28667,28675,28684,28693,28701,28710,28719,28727,
        28736,28744,28753,28762,28770,28779,28787,28796,28804,28813,
        28821,28830,28838,28847,28855,28864,28872,28881,28889,28897,
        28906,28914,28923,28931,28939,28948,28956,28965,28973,28981,
        28990,28998,29006,29015,29023,29031,29039,29048,29056,29064,
        29072,29081,29089,29097,29105,29114,29122,29130,29138,29146,
        29154,29163,29171,29179,29187,29195,29203,29211,29219,29227,
        29236,29244,29252,29260,29268,29276,29284,29292,29300,29308,
        29316,29324,29332,29340,29348,29356,29364,29372,29379,29387,
        29395,29403,29411,29419,29427,29435,29442,29450,29458,29466,
        29474,29482,29489,29497,29505,29513,29520,29528,29536,29544,
        29551,29559,29567,29575,29582,29590,29598,29605,29613,29621,
        29628,29636,29643,29651,29659,29666,29674,29681,29689,29696,
        29704,29712,29719,29727,29734,29742,29749,29757,29764,29772,
        29779,29786,29794,29801,29809,29816,29824,29831,29838,29846,
        29853,29861,29868,29875,29883,29890,29897,29904,29912,29919,
        29926,29934,29941,29948,29955,29963,29970,29977,29984,29992,
        29999,30006,30013,30020,30027,30035,30042,30049,30056,30063,
        30070,30077,30084,30091,30098,30106,30113,30120,30127,30134,
        30141,30148,30155,30162,30169,30176,30183,30190,30196,30203,
        30210,30217,30224,30231,30238,30245,30252,30259,30265,30272,
        30279,30286,30293,30300,30306,30313,30320,30327,30333,30340,
        30347,30354,30360,30367,30374,30381,30387,30394,30401,30407,
        30414,30421,30427,30434,30440,30447,30454,30460,30467,30473,
        30480,30486,30493,30500,30506,30513,30519,30526,30532,30539,
        30545,30552,30558,30564,30571,30577,30584,30590,30597,30603,
        30609,30616,30622,30628,30635,30641,30647,30654,30660,30666,
        30673,30679,30685,30691,30698,30704,30710,30716,30723,30729,
        30735,30741,30747,30754,30760,30766,30772,30778,30784,30790,
        30797,30803,30809,30815,30821,30827,30833,30839,30845,30851,
        30857,30863,30869,30875,30881,30887,30893,30899,30905,30911,
        30917,30923,30929,30934,30940,30946,30952,30958,30964,30970,
        30975,30981,30987,30993,30999,31005,31010,31016,31022,31028,
        31033,31039,31045,31050,31056,31062,31068,31073,31079,31085,
        31090,31096,31101,31107,31113,31118,31124,31129,31135,31141,
        31146,31152,31157,31163,31168,31174,31179,31185,31190,31196,
        31201,31207,31212,31218,31223,31228,31234,31239,31245,31250,
        31255,31261,31266,31271,31277,31282,31287,31293,31298,31303,
        31308,31314,31319,31324,31330,31335,31340,31345,31350,31356,
        31361,31366,31371,31376,31381,31387,31392,31397,31402,31407,
        31412,31417,31422,31427,31432,31437,31442,31447,31452,31457,
        31462,31467,31472,31477,31482,31487,31492,31497,31502,31507,
        31512,31517,31522,31527,31531,31536,31541,31546,31551,31556,
        31560,31565,31570,31575,31580,31584,31589,31594,31599,31603,
        31608,31613,31617,31622,31627,31631,31636,31641,31645,31650,
        31655,31659,31664,31668,31673,31678,31682,31687,31691,31696,
        31700,31705,31709,31714,31718,31723,31727,31732,31736,31741,
        31745,31749,31754,31758,31763,31767,31771,31776,31780,31785,
        31789,31793,31797,31802,31806,31810,31815,31819,31823,31827,
        31832,31836,31840,31844,31849,31853,31857,31861,31865,31869,
        31874,31878,31882,31886,31890,31894,31898,31902,31906,31911,
        31915,31919,31923,31927,31931,31935,31939,31943,31947,31951,
        31955,31959,31962,31966,31970,31974,31978,31982,31986,31990,
        31994,31998,32001,32005,32009,32013,32017,32020,32024,32028,
        32032,32036,32039,32043,32047,32050,32054,32058,32062,32065,
        32069,32073,32076,32080,32084,32087,32091,32094,32098,32102,
        32105,32109,32112,32116,32119,32123,32126,32130,32133,32137,
        32140,32144,32147,32151,32154,32158,32161,32164,32168,32171,
        32175,32178,32181,32185,32188,32191,32195,32198,32201,32205,
        32208,32211,32215,32218,32221,32224,32228,32231,32234,32237,
        32240,32244,32247,32250,32253,32256,32259,32262,32266,32269,
        32272,32275,32278,32281,32284,32287,32290,32293,32296,32299,
        32302,32305,32308,32311,32314,32317,32320,32323,32326,32329,
        32332,32335,32338,32340,32343,32346,32349,32352,32355,32357,
        32360,32363,32366,32369,32371,32374,32377,32380,32382,32385,
        32388,32391,32393,32396,32399,32401,32404,32407,32409,32412,
        32414,32417,32420,32422,32425,32427,32430,32433,32435,32438,
        32440,32443,32445,32448,32450,32453,32455,32457,32460,32462,
        32465,32467,32470,32472,32474,32477,32479,32481,32484,32486,
        32489,32491,32493,32495,32498,32500,32502,32505,32507,32509,
        32511,32513,32516,32518,32520,32522,32524,32527,32529,32531,
        32533,32535,32537,32539,32541,32544,32546,32548,32550,32552,
        32554,32556,32558,32560,32562,32564,32566,32568,32570,32572,
        32574,32576,32578,32579,32581,32583,32585,32587,32589,32591,
        32593,32594,32596,32598,32600,32602,32603,32605,32607,32609,
        32610,32612,32614,32616,32617,32619,32621,32622,32624,32626,
        32627,32629,32631,32632,32634,32636,32637,32639,32640,32642,
        32643,32645,32646,32648,32649,32651,32652,32654,32655,32657,
        32658,32660,32661,32663,32664,32665,32667,32668,32670,32671,
        32672,32674,32675,32676,32678,32679,32680,32682,32683,32684,
        32685,32687,32688,32689,32690,32692,32693,32694,32695,32696,
        32698,32699,32700,32701,32702,32703,32704,32705,32706,32708,
        32709,32710,32711,32712,32713,32714,32715,32716,32717,32718,
        32719,32720,32721,32722,32723,32723,32724,32725,32726,32727,
        32728,32729,32730,32730,32731,32732,32733,32734,32735,32735,
        32736,32737,32738,32738,32739,32740,32741,32741,32742,32743,
        32743,32744,32745,32745,32746,32747,32747,32748,32748,32749,
        32750,32750,32751,32751,32752,32752,32753,32753,32754,32754,
        32755,32755,32756,32756,32757,32757,32757,32758,32758,32759,
        32759,32759,32760,32760,32761,32761,32761,32762,32762,32762,
        32762,32763,32763,32763,32763,32764,32764,32764,32764,32765,
        32765,32765,32765,32765,32765,32766,32766,32766,32766,32766,
        32766,32766,32766,32766,32766,32766,32766,32766,32766,32767};

trigonometric sine(uint16_t original_angle){
    uint16_t positive_angle = (original_angle & 0b0111111111111111);
    //TODO - how to calculate the module in a better way in this architecture?
    uint16_t normalized_angle = positive_angle % (360 << 5);
    uint16_t last_angle;

    //In this code, I changed an angle between 0 and 360 to an angle between 0 and 90
    if(normalized_angle > (180 << 5))
        last_angle = normalized_angle - (180 << 5);
    if(last_angle > (90 << 5))
        last_angle = (180 << 5) - normalized_angle;

    //I want to avoid pipeline breaks, so I'll check in which quadrant the angle is, based on a division by 4
    uint8_t divided = normalized_angle / (90 << 4);
    uint8_t negativeCos = 

}